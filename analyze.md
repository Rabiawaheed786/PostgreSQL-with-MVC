# Book Library Project Analysis

This document provides a detailed analysis of the Book Library project, covering its architecture, technologies, and functionality.

## Project Overview

This project is a Node.js-based web application that serves as a backend for a book library. It uses the Express.js framework to create a RESTful API for managing books and authors. The project is set up to use a PostgreSQL database and leverages the Drizzle ORM for database interactions. It also includes a Docker configuration for easy setup of the development environment.

## Project Structure

The project follows a standard Model-View-Controller (MVC) like architecture, separating concerns into different directories:

-   **`controllers/`**: Contains the business logic of the application. The controller functions are responsible for handling incoming requests, interacting with the models, and sending responses.
    -   `books.controller.js`: Currently contains a placeholder function `getAllBook` to handle requests for fetching all books.

-   **`db/`**: This directory is intended for database-related files.
    -   `connection.js`: Sets up the connection to the PostgreSQL database using Drizzle ORM and the connection string from the `.env` file.

-   **`drizzle/`**: This directory will store the SQL migration files generated by Drizzle Kit. These files track changes to the database schema over time.

-   **`middlewares/`**: Contains middleware functions that can process requests before they reach the route handlers.
    -   `globalmiddleware.js`: A simple middleware that logs a message to the console for every incoming request.

-   **`models/`**: Defines the database schema using Drizzle ORM.
    -   `author.model.js`: Defines the `authorTable` with columns for author ID, first name, last name, and email.
    -   `book.model.js`: Defines the `bookTable` with columns for book ID, title, description, and a foreign key relationship to the `authorTable`. It also includes a GIN index on the `title` for efficient full-text searching.
    -   `index.js`: Exports all the table schemas, making them easily accessible to other parts of the application.

-   **`routes/`**: Defines the API routes and maps them to the corresponding controller functions.
    -   `book.route.js`: Defines a single `GET /` route that is handled by the `getAllBook` controller.

-   **`index.js`**: The main entry point of the application. It initializes the Express app, sets up middleware, mounts the routes, and starts the server on port 8000.

-   **`package.json`**: Lists the project's dependencies and scripts. Key dependencies include `express`, `drizzle-orm`, `pg` (for the PostgreSQL driver), and `dotenv`.

-   **`docker-compose.yaml`**: A Docker Compose file to simplify the setup of the development environment. It defines a `postgres` service, which runs a PostgreSQL 17.4 container, and configures the database name, user, and password.

-   **`drizzle.config.js`**: The configuration file for Drizzle Kit, specifying the location of the schema, the output directory for migrations, and the database connection details.

-   **`.env`**: This file should contain the environment variables for the project, such as the `DATABASE_URL`.

## Technologies Used

-   **Backend**: Node.js with Express.js
-   **Database**: PostgreSQL
-   **ORM**: Drizzle ORM
-   **Containerization**: Docker
-   **Dev Dependencies**: `drizzle-kit` for database migrations.

## Database Schema

The database consists of two tables:

1.  **`Author`**:
    -   `id` (UUID, Primary Key)
    -   `firstName` (Varchar)
    -   `lastName` (Varchar)
    -   `email` (Varchar, Unique)

2.  **`bookLibrary`**:
    -   `id` (UUID, Primary Key)
    -   `title` (Varchar)
    -   `description` (Text)
    -   `authorId` (UUID, Foreign Key to `Author.id`)

There is a one-to-many relationship between `Author` and `bookLibrary` (one author can have multiple books).

## API Endpoints

Currently, there is only one endpoint defined:

-   **`GET /`**: This route is intended to fetch all books. At the moment, it returns a simple JSON message: `{"message": "i m get response"}`.

## How to Run the Project

1.  **Create a `.env` file** in the root of the project with the following content:
    ```
    DATABASE_URL=postgres://postgres:admin@localhost:5432/book-store
    ```
2.  **Start the database**: Run `docker-compose up -d` to start the PostgreSQL container in the background.
3.  **Install dependencies**: Run `npm install` to install all the required packages.
4.  **Run database migrations**: Run `npx drizzle-kit generate` to create the initial migration files, and then `npx drizzle-kit migrate` to apply the schema to the database.
5.  **Start the application**: Run `npm start` (or `node index.js`) to start the Express server. The server will be running on `http://localhost:8000`.
